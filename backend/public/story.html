<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trip Story - TravelAgent</title>
  <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_KEY"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #0F172A 0%, #1E293B 100%);
      color: white;
      overflow-x: hidden;
    }

    .hero {
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 20px;
      position: relative;
      background: radial-gradient(circle at 50% 50%, rgba(139, 92, 246, 0.1) 0%, transparent 50%);
    }

    .hero h1 {
      font-size: 3.5rem;
      font-weight: 900;
      margin-bottom: 1rem;
      background: linear-gradient(135deg, #A78BFA 0%, #F472B6 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .hero .subtitle {
      font-size: 1.5rem;
      color: #94A3B8;
      margin-bottom: 2rem;
    }

    .stats {
      display: flex;
      gap: 3rem;
      margin-bottom: 3rem;
    }

    .stat {
      text-align: center;
    }

    .stat-value {
      font-size: 3rem;
      font-weight: 900;
      color: #8B5CF6;
    }

    .stat-label {
      font-size: 1rem;
      color: #64748B;
      margin-top: 0.5rem;
    }

    .map-container {
      width: 90%;
      max-width: 1200px;
      height: 500px;
      border-radius: 24px;
      overflow: hidden;
      margin: 3rem auto;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      border: 2px solid rgba(139, 92, 246, 0.3);
    }

    #map {
      width: 100%;
      height: 100%;
    }

    .timeline {
      max-width: 800px;
      margin: 0 auto;
      padding: 3rem 20px;
    }

    .timeline h2 {
      font-size: 2.5rem;
      font-weight: 900;
      margin-bottom: 2rem;
      text-align: center;
    }

    .timeline-item {
      background: rgba(30, 41, 59, 0.6);
      border: 2px solid rgba(139, 92, 246, 0.3);
      border-radius: 20px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      backdrop-filter: blur(10px);
    }

    .timeline-item h3 {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
    }

    .timeline-item .location {
      color: #94A3B8;
      margin-bottom: 1rem;
    }

    .timeline-item .rating {
      color: #FBBF24;
      font-size: 1.2rem;
    }

    .cta-section {
      text-align: center;
      padding: 5rem 20px;
      background: linear-gradient(180deg, transparent 0%, rgba(139, 92, 246, 0.1) 100%);
    }

    .cta-section h2 {
      font-size: 2.5rem;
      font-weight: 900;
      margin-bottom: 1rem;
    }

    .cta-section p {
      font-size: 1.25rem;
      color: #94A3B8;
      margin-bottom: 2rem;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    .app-buttons {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .app-button {
      display: inline-flex;
      align-items: center;
      gap: 0.75rem;
      background: white;
      color: #0F172A;
      padding: 1rem 2rem;
      border-radius: 16px;
      text-decoration: none;
      font-weight: 700;
      font-size: 1.1rem;
      transition: transform 0.2s, box-shadow 0.2s;
      box-shadow: 0 10px 30px rgba(139, 92, 246, 0.3);
    }

    .app-button:hover {
      transform: translateY(-4px);
      box-shadow: 0 15px 40px rgba(139, 92, 246, 0.5);
    }

    .app-button img {
      width: 24px;
      height: 24px;
    }

    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 2rem;
      max-width: 1000px;
      margin: 3rem auto 0;
      padding: 0 20px;
    }

    .feature {
      text-align: center;
      padding: 2rem;
      background: rgba(30, 41, 59, 0.4);
      border-radius: 20px;
      border: 2px solid rgba(139, 92, 246, 0.2);
    }

    .feature-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
    }

    .feature h3 {
      font-size: 1.25rem;
      margin-bottom: 0.5rem;
    }

    .feature p {
      color: #94A3B8;
      font-size: 0.95rem;
    }

    footer {
      text-align: center;
      padding: 3rem 20px;
      color: #64748B;
    }

    .blur-overlay {
      position: relative;
    }

    .blur-overlay::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 200px;
      background: linear-gradient(to bottom, transparent, #0F172A);
      pointer-events: none;
    }

    @media (max-width: 768px) {
      .hero h1 {
        font-size: 2.5rem;
      }
      .stats {
        gap: 1.5rem;
      }
      .stat-value {
        font-size: 2rem;
      }
    }
  </style>
</head>
<body>
  <div class="hero">
    <h1 id="trip-title">Loading...</h1>
    <p class="subtitle" id="trip-subtitle"></p>
    
    <div class="stats">
      <div class="stat">
        <div class="stat-value" id="places-count">0</div>
        <div class="stat-label">Places Visited</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="days-count">0</div>
        <div class="stat-label">Days</div>
      </div>
    </div>

    <p style="font-size: 1.1rem; color: #64748B; margin-bottom: 1rem;">üìç Scroll down to see the journey</p>
  </div>

  <div class="map-container blur-overlay">
    <div id="map"></div>
  </div>

  <div class="timeline" id="timeline">
    <h2>The Journey üó∫Ô∏è</h2>
    <!-- Timeline items will be injected here -->
  </div>

  <!-- THE CARROT: Download CTA -->
  <div class="cta-section">
    <h2>Want to Create Your Own Trip Story?</h2>
    <p>
      Download TravelAgent and start planning your next adventure. 
      Save places from Instagram & YouTube, track your visits, and share your journey!
    </p>

    <div class="app-buttons">
      <a href="#" class="app-button">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M17.05 20.28c-.98.95-2.05.8-3.08.35-1.09-.46-2.09-.48-3.24 0-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"/>
        </svg>
        App Store
      </a>
      <a href="#" class="app-button">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M3,20.5V3.5C3,2.91 3.34,2.39 3.84,2.15L13.69,12L3.84,21.85C3.34,21.6 3,21.09 3,20.5M16.81,15.12L6.05,21.34L14.54,12.85L16.81,15.12M20.16,10.81C20.5,11.08 20.75,11.5 20.75,12C20.75,12.5 20.5,12.92 20.16,13.19L17.89,14.5L15.39,12L17.89,9.5L20.16,10.81M6.05,2.66L16.81,8.88L14.54,11.15L6.05,2.66Z"/>
        </svg>
        Play Store
      </a>
    </div>

    <div class="features">
      <div class="feature">
        <div class="feature-icon">üé¨</div>
        <h3>Save from Social</h3>
        <p>Paste YouTube & Instagram links to save places instantly</p>
      </div>
      <div class="feature">
        <div class="feature-icon">üó∫Ô∏è</div>
        <h3>Beautiful Maps</h3>
        <p>See all your saved places on an interactive dark neon map</p>
      </div>
      <div class="feature">
        <div class="feature-icon">üéØ</div>
        <h3>Check-In & Share</h3>
        <p>Track visits, earn XP, and share your journey like this!</p>
      </div>
    </div>
  </div>

  <footer>
    <p>Made with ‚ù§Ô∏è by TravelAgent</p>
    <p style="margin-top: 0.5rem; font-size: 0.9rem;">Plan better. Travel smarter. Share easier.</p>
  </footer>

  <script>
    // Extract share code from URL
    const pathParts = window.location.pathname.split('/');
    const shareCode = pathParts[pathParts.length - 1];

    // Fetch story data
    async function loadStory() {
      try {
        const response = await fetch(`https://travelbuddy-production-1d2c.up.railway.app/api/story/${shareCode}`);
        const data = await response.json();

        if (data.success) {
          const { story, timeline, stats } = data.data;

          // Update hero
          document.getElementById('trip-title').textContent = story.title || 'Trip Story';
          document.getElementById('trip-subtitle').textContent = story.description || '';
          document.getElementById('places-count').textContent = stats?.total_places || 0;
          document.getElementById('days-count').textContent = timeline?.length || 0;

          // Initialize map
          const map = new google.maps.Map(document.getElementById('map'), {
            center: { lat: 35.6762, lng: 139.6503 },
            zoom: 10,
            styles: [/* Dark neon style from your config */],
          });

          // Add markers for each check-in
          if (timeline) {
            timeline.forEach(day => {
              day.check_ins.forEach(checkin => {
                if (checkin.actual_location_lat && checkin.actual_location_lng) {
                  new google.maps.Marker({
                    position: { lat: checkin.actual_location_lat, lng: checkin.actual_location_lng },
                    map: map,
                    title: checkin.place_name,
                  });
                }
              });
            });
          }

          // Render timeline
          const timelineEl = document.getElementById('timeline');
          if (timeline) {
            timeline.forEach(day => {
              day.check_ins.forEach(checkin => {
                const item = document.createElement('div');
                item.className = 'timeline-item';
                item.innerHTML = `
                  <h3>${checkin.place_name}</h3>
                  <p class="location">${checkin.place_location || 'Unknown location'}</p>
                  ${checkin.rating ? `<p class="rating">${'‚≠ê'.repeat(checkin.rating)}</p>` : ''}
                  ${checkin.note ? `<p>${checkin.note}</p>` : ''}
                `;
                timelineEl.appendChild(item);
              });
            });
          }
        } else {
          document.getElementById('trip-title').textContent = 'Story Not Found';
          document.getElementById('trip-subtitle').textContent = 'This story might be private or expired.';
        }
      } catch (error) {
        console.error('Failed to load story:', error);
        document.getElementById('trip-title').textContent = 'Failed to Load';
      }
    }

    loadStory();
  </script>
</body>
</html>

